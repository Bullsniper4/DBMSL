-- Part A: DDL - Create Tables, View, Index + Sample Data

--  Drop old database for fresh start
DROP DATABASE IF EXISTS college;
CREATE DATABASE college;
USE college;

--  Create Student table
CREATE TABLE Student (
    student_id INT AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50),
    date_of_birth DATE,
    department VARCHAR(30),
    email VARCHAR(100) UNIQUE,
    marks DECIMAL(5,2),
    grade CHAR(2)
);

--  Create Course table
CREATE TABLE Course (
    course_id INT AUTO_INCREMENT PRIMARY KEY,
    course_name VARCHAR(50) NOT NULL,
    credits INT
);

--  Create Enrollment table (Many-to-Many relationship)
CREATE TABLE Enrollment (
    enroll_id INT AUTO_INCREMENT PRIMARY KEY,
    student_id INT,
    course_id INT,
    enroll_date DATE DEFAULT (CURDATE()),
    FOREIGN KEY (student_id) REFERENCES Student(student_id) ON DELETE CASCADE,
    FOREIGN KEY (course_id) REFERENCES Course(course_id)
);

--  Insert sample data into Student
INSERT INTO Student (first_name, last_name, date_of_birth, department, email, marks, grade)
VALUES 
('Amit', 'Sharma', '2003-05-21', 'CSE', 'amit@gmail.com', 89.5, 'A'),
('Riya', 'Patil', '2004-02-13', 'IT', 'riya@gmail.com', 76.0, 'B'),
('John', 'Doe', '2002-08-10', 'ECE', 'john@gmail.com', 91.0, 'A'),
('Sara', 'Singh', '2003-11-05', 'CSE', 'sara@gmail.com', 65.0, 'C');

--  Insert sample data into Course
INSERT INTO Course (course_name, credits)
VALUES 
('Database Systems', 4),
('Operating Systems', 3),
('AI Fundamentals', 4),
('Networking', 3);

--  Insert sample data into Enrollment
INSERT INTO Enrollment (student_id, course_id, enroll_date)
VALUES
(1, 1, CURDATE()),
(1, 2, CURDATE()),
(2, 3, CURDATE()),
(3, 4, CURDATE()),
(4, 1, CURDATE());

--  Create a simple view for high scorers
CREATE VIEW High_Scorers AS
SELECT student_id, first_name, last_name, marks, grade
FROM Student
WHERE marks > 80;

--  Create an index on student name
CREATE INDEX idx_student_name ON Student(first_name, last_name);

--  Show all tables created
SHOW TABLES;

--  Show structure of each table
DESCRIBE Student;
DESCRIBE Course;
DESCRIBE Enrollment;

--  Show data in each table
SELECT * FROM Student;
SELECT * FROM Course;
SELECT * FROM Enrollment;

--  Show data from the view

SELECT * FROM High_Scorers;
